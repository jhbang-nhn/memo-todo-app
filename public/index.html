<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>for PURIN - TODO 앱</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 로그인 화면 -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <h2>for PURIN 로그인</h2>
            <form id="loginForm">
                <input type="text" id="username" placeholder="사용자명" required>
                <input type="password" id="password" placeholder="비밀번호" required>
                <button type="submit">로그인</button>
            </form>
        </div>
    </div>

    <!-- 메인 앱 화면 -->
    <div id="appScreen" class="app-screen hidden">
        <header class="header">
            <h1>for PURIN</h1>
            <button id="logoutBtn" class="logout-btn">로그아웃</button>
        </header>
        
        <main class="main-container">
            <!-- 왼쪽: 달력 -->
            <section class="calendar-section">
                <div class="calendar-header">
                    <button id="prevMonth" class="nav-btn">&lt;</button>
                    <h2 id="currentMonth"></h2>
                    <button id="nextMonth" class="nav-btn">&gt;</button>
                </div>
                <div class="calendar-grid">
                    <div class="calendar-weekdays">
                        <div>일</div>
                        <div>월</div>
                        <div>화</div>
                        <div>수</div>
                        <div>목</div>
                        <div>금</div>
                        <div>토</div>
                    </div>
                    <div id="calendarDays" class="calendar-days"></div>
                </div>
                
                <!-- 커스텀 휴일 관리 -->
                <div class="custom-holidays-section">
                    <div class="section-header">
                        <h4>커스텀 휴일</h4>
                        <button id="addHolidayBtn" class="add-btn">+</button>
                    </div>
                    <div id="customHolidaysList" class="custom-holidays-list"></div>
                    <div id="addHolidayForm" class="add-form hidden">
                        <div class="form-group">
                            <label>휴일 타입</label>
                            <div class="holiday-type-buttons">
                                <button type="button" class="type-btn active" data-type="single">단일 날짜</button>
                                <button type="button" class="type-btn" data-type="range">범위 선택</button>
                            </div>
                            <input type="hidden" name="holidayType" value="single">
                        </div>
                        
                        <!-- 단일 날짜 입력 -->
                        <div id="singleDateInput" class="date-input">
                            <div class="form-group">
                                <label for="holidayDate">날짜</label>
                                <div class="custom-date-picker">
                                    <input type="text" id="holidayDate" placeholder="YYYY-MM-DD" readonly required onclick="showDatePicker('holidayDate')">
                                </div>
                                <div id="holidayDatePicker" class="date-picker-popup hidden">
                                    <div class="date-picker-header">
                                        <button type="button" class="date-nav-btn" onclick="changePickerMonth('holidayDate', -1)">&lt;</button>
                                        <span id="holidayDatePickerMonth"></span>
                                        <button type="button" class="date-nav-btn" onclick="changePickerMonth('holidayDate', 1)">&gt;</button>
                                    </div>
                                    <div class="date-picker-weekdays">
                                        <div>일</div><div>월</div><div>화</div><div>수</div><div>목</div><div>금</div><div>토</div>
                                    </div>
                                    <div id="holidayDatePickerDays" class="date-picker-days"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 범위 날짜 입력 -->
                        <div id="rangeDateInput" class="date-input" style="display: none;">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="holidayStartDate">시작일</label>
                                    <div class="custom-date-picker">
                                        <input type="text" id="holidayStartDate" placeholder="YYYY-MM-DD" readonly required onclick="showDatePicker('holidayStartDate')">
                                    <div id="holidayStartDatePicker" class="date-picker-popup hidden">
                                        <div class="date-picker-header">
                                            <button type="button" class="date-nav-btn" onclick="changePickerMonth('holidayStartDate', -1)">&lt;</button>
                                            <span id="holidayStartDatePickerMonth"></span>
                                            <button type="button" class="date-nav-btn" onclick="changePickerMonth('holidayStartDate', 1)">&gt;</button>
                                        </div>
                                        <div class="date-picker-weekdays">
                                            <div>일</div><div>월</div><div>화</div><div>수</div><div>목</div><div>금</div><div>토</div>
                                        </div>
                                        <div id="holidayStartDatePickerDays" class="date-picker-days"></div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="holidayEndDate">종료일</label>
                                    <div class="custom-date-picker">
                                        <input type="text" id="holidayEndDate" placeholder="YYYY-MM-DD" readonly required onclick="showDatePicker('holidayEndDate')">
                                    </div>
                                    <div id="holidayEndDatePicker" class="date-picker-popup hidden">
                                        <div class="date-picker-header">
                                            <button type="button" class="date-nav-btn" onclick="changePickerMonth('holidayEndDate', -1)">&lt;</button>
                                            <span id="holidayEndDatePickerMonth"></span>
                                            <button type="button" class="date-nav-btn" onclick="changePickerMonth('holidayEndDate', 1)">&gt;</button>
                                        </div>
                                        <div class="date-picker-weekdays">
                                            <div>일</div><div>월</div><div>화</div><div>수</div><div>목</div><div>금</div><div>토</div>
                                        </div>
                                        <div id="holidayEndDatePickerDays" class="date-picker-days"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="range-info">
                                <span id="rangeDuration">기간: 1일</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>색상</label>
                            <div class="color-picker">
                                <button type="button" class="color-btn" data-color="#ff6b6b" style="background-color: #ff6b6b;" title="빨강"></button>
                                <button type="button" class="color-btn" data-color="#4ecdc4" style="background-color: #4ecdc4;" title="청록"></button>
                                <button type="button" class="color-btn" data-color="#45b7d1" style="background-color: #45b7d1;" title="하늘"></button>
                                <button type="button" class="color-btn" data-color="#f9ca24" style="background-color: #f9ca24;" title="노랑"></button>
                                <button type="button" class="color-btn" data-color="#a55eea" style="background-color: #a55eea;" title="보라"></button>
                                <button type="button" class="color-btn" data-color="#fd79a8" style="background-color: #fd79a8;" title="분홍"></button>
                                <button type="button" class="color-btn" data-color="#e84393" style="background-color: #e84393;" title="마젠타"></button>
                                <button type="button" class="color-btn" data-color="#00b894" style="background-color: #00b894;" title="초록"></button>
                                <button type="button" class="color-btn" data-color="#d63031" style="background-color: #d63031;" title="진빨강"></button>
                                <button type="button" class="color-btn" data-color="#636e72" style="background-color: #636e72;" title="회색"></button>
                            </div>
                            <input type="hidden" id="holidayColor" value="#ff6b6b">
                        </div>
                        
                        <div class="form-group">
                            <label for="holidayName">기념일 이름</label>
                            <input type="text" id="holidayName" placeholder="기념일 이름" required>
                        </div>
                        
                        <div class="form-buttons">
                            <button id="saveHolidayBtn">저장</button>
                            <button id="cancelHolidayBtn">취소</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 오른쪽: TODO와 메모 -->
            <section class="content-section">
                <div class="selected-date">
                    <h3 id="selectedDateTitle"></h3>
                    <div id="selectedDateHoliday" class="selected-date-holiday hidden" onclick="editSelectedDateHoliday()">
                        <div class="holiday-info">
                            <span class="holiday-color-dot"></span>
                            <span class="holiday-name"></span>
                        </div>
                    </div>
                </div>
                
                <!-- TODO 섹션 -->
                <div class="todo-section">
                    <div class="section-header">
                        <h4>TODO</h4>
                        <button id="addTodoBtn" class="add-btn">+</button>
                    </div>
                    <div id="todoList" class="todo-list"></div>
                    <div id="addTodoForm" class="add-form hidden">
                        <input type="text" id="todoTitle" placeholder="TODO 제목">
                        <textarea id="todoDescription" placeholder="설명 (선택사항)"></textarea>
                        <div class="form-buttons">
                            <button id="saveTodoBtn">저장</button>
                            <button id="cancelTodoBtn">취소</button>
                        </div>
                    </div>
                </div>

                <!-- 메모 섹션 -->
                <div class="memo-section">
                    <div class="section-header">
                        <h4>메모</h4>
                        <button id="addMemoBtn" class="add-btn">+</button>
                    </div>
                    <div id="memoList" class="memo-list"></div>
                    <div id="addMemoForm" class="add-form hidden">
                        <div class="markdown-editor">
                            <div class="editor-toolbar">
                                <button type="button" class="toolbar-btn" data-action="bold" title="굵게 (Ctrl+B)">B</button>
                                <button type="button" class="toolbar-btn" data-action="italic" title="기울임 (Ctrl+I)">I</button>
                                <button type="button" class="toolbar-btn" data-action="code" title="코드 (Ctrl+`)">`</button>
                                <button type="button" class="toolbar-btn" data-action="link" title="링크">🔗</button>
                                <button type="button" class="toolbar-btn" data-action="list" title="목록">•</button>
                                <button type="button" class="toolbar-btn" data-action="heading" title="제목">H</button>
                                <button type="button" class="toolbar-btn" data-action="quote" title="인용">"</button>
                            </div>
                            <div class="editor-container">
                                <div class="editor-pane">
                                    <div class="pane-header">마크다운 편집</div>
                                    <textarea id="memoContent" placeholder="메모 내용을 입력하세요...&#10;&#10;마크다운 문법 지원:&#10;• **굵게** 또는 Ctrl+B&#10;• *기울임* 또는 Ctrl+I&#10;• `코드` 또는 Ctrl+`&#10;• [링크](URL)&#10;• - 목록 항목&#10;• # 제목&#10;• > 인용문"></textarea>
                                </div>
                                <div class="editor-pane">
                                    <div class="pane-header">미리보기</div>
                                    <div id="memoPreview" class="markdown-preview"></div>
                                </div>
                            </div>
                        </div>
                        <div class="form-buttons">
                            <button id="saveMemoBtn">저장</button>
                            <button id="cancelMemoBtn">취소</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- 수정 모달 -->
    <div id="editModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">수정</h3>
                <button id="closeModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <!-- TODO 수정 폼 -->
                <div id="editTodoForm" class="edit-form hidden">
                    <div class="form-group">
                        <label for="editTodoTitle">제목</label>
                        <input type="text" id="editTodoTitle" placeholder="TODO 제목">
                    </div>
                    <div class="form-group">
                        <label for="editTodoDescription">설명</label>
                        <textarea id="editTodoDescription" placeholder="설명 (선택사항)"></textarea>
                    </div>
                </div>
                
                <!-- 메모 수정 폼 -->
                <div id="editMemoForm" class="edit-form hidden">
                    <div class="form-group">
                        <label for="editMemoContent">내용</label>
                        <div class="markdown-editor">
                            <div class="editor-toolbar">
                                <button type="button" class="toolbar-btn" data-action="bold" title="굵게 (Ctrl+B)">B</button>
                                <button type="button" class="toolbar-btn" data-action="italic" title="기울임 (Ctrl+I)">I</button>
                                <button type="button" class="toolbar-btn" data-action="code" title="코드 (Ctrl+`)">`</button>
                                <button type="button" class="toolbar-btn" data-action="link" title="링크">🔗</button>
                                <button type="button" class="toolbar-btn" data-action="list" title="목록">•</button>
                                <button type="button" class="toolbar-btn" data-action="heading" title="제목">H</button>
                                <button type="button" class="toolbar-btn" data-action="quote" title="인용">"</button>
                            </div>
                            <div class="editor-container">
                                <div class="editor-pane">
                                    <div class="pane-header">마크다운 편집</div>
                                    <textarea id="editMemoContent" placeholder="메모 내용을 입력하세요...&#10;&#10;마크다운 문법 지원:&#10;• **굵게** 또는 Ctrl+B&#10;• *기울임* 또는 Ctrl+I&#10;• `코드` 또는 Ctrl+`&#10;• [링크](URL)&#10;• - 목록 항목&#10;• # 제목&#10;• > 인용문"></textarea>
                                </div>
                                <div class="editor-pane">
                                    <div class="pane-header">미리보기</div>
                                    <div id="editMemoPreview" class="markdown-preview"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveEditBtn" class="save-btn">저장</button>
                <button id="cancelEditBtn" class="cancel-btn">취소</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js"></script>
    <script src="constants.js"></script>
    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html>
